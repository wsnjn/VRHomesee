# 后端技术文档

本项目后端基于 **Spring Boot 3** 构建，提供稳健的 RESTful API 服务。采用分层架构设计，集成了 MySQL 持久化存储与 JPA 数据访问。

## 1. 技术栈 (Tech Stack)

| 类别         | 技术 / 库       | 版本   | 说明                          |
| :----------- | :-------------- | :----- | :---------------------------- |
| **开发语言** | Java            | 17 LTS | 强类型、高并发支持            |
| **Web 框架** | Spring Boot     | 3.2.0  | 快速构建生产级应用            |
| **ORM 框架** | Spring Data JPA | -      | 基于 Hibernate 的对象关系映射 |
| **数据库**   | MySQL           | 8.0+   | 关系型数据存储                |
| **构建工具** | Maven           | 3.8+   | 依赖管理与打包                |
| **测试**     | JUnit 5         | -      | 单元测试与集成测试            |

## 2. 系统架构 (Architecture)

后端遵循标准的 **Controller-Service-Repository** 三层架构：

*   **API 层 (Controller)**: 
    *   处理 HTTP 请求 (GET/POST/PUT/DELETE)。
    *   参数校验与响应格式化 (JSON)。
    *   位置: `src/main/java/com/example/homesee/controller`
*   **业务层 (Service)**: 
    *   核心业务逻辑封装 (如：合同生成逻辑、预约冲突检测)。
    *   事务管理 (`@Transactional`)。
    *   位置: `src/main/java/com/example/homesee/service`
*   **数据层 (Repository)**: 
    *   继承 `JpaRepository`，提供开箱即用的 CRUD 操作。
    *   编写自定义 JPQL 或 Native SQL 查询。
    *   实体定义: `src/main/java/com/example/homesee/entity`

## 3. 核心模块与功能

| 模块           | 关键类                  | 功能描述                                   |
| :------------- | :---------------------- | :----------------------------------------- |
| **用户与权限** | `UserController`        | 注册/登录、实名认证、个人画像管理。        |
| **房源中心**   | `RoomInfoController`    | 房源发布、多维度筛选 (Filter)、状态流转。  |
| **VR 服务**    | `RoomVrSceneController` | VR 场景元数据管理、文件链接存储。          |
| **租赁业务**   | `TenantManagement`      | 电子合同生命周期、租金账单生成、水电抄表。 |
| **看房预约**   | `ViewingAppointment`    | 预约申请、房东审批、中介指派流程。         |
| **社区互动**   | `CommunityController`   | 社交动态发布、IM 消息存储、群组管理。      |
| **AI 匹配**    | `SmartMatching`         | RAG 检索意图识别、AI 对话历史记录。        |

## 4. 数据库设计要点

系统包含以下核心数据表 (通过 Entity 自动映射)：
*   `user`: 全局用户表 (含角色、信用分)。
*   `room_info`: 房源主表。
*   `room_vr_scene`: 房源关联的 VR 子数据。
*   `tenant_management`: 租客合同与租务记录。
*   `maintenance_request`: 维修工单。
*   `chat_message` / `social_post`: 社区与聊天数据。

## 5. 安装与运行

确保已安装 JDK 17 和 Maven。

```bash
# 1. 进入后端目录
cd Springboot

# 2. 配置数据库
# 修改 src/main/resources/application.properties 
# 设置 spring.datasource.url / username / password

# 3. 编译并运行
mvn spring-boot:run

# 或者打包为 JAR 运行
mvn clean package
java -jar target/homesee-0.0.1-SNAPSHOT.jar
```

## 6. API 规范
*   **基础路径**: `/api/` (如 `/api/user/login`)
*   **跨域配置**: 已在 `CorsConfig.java` 中配置允许 `localhost:5173` 及生产域名访问。
*   **响应格式**: 多数接口返回标准 JSON 对象，包含 `success`, `message`, `data` 字段。
